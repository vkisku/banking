<!doctype html>
<html lang="en">
<head>
    <title>Digital Mine(IoT) | CSIR-CIMFR | Configuration</title>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% block content %}
    {% load staticfiles %}

    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'css/toastr.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/filepond.css' %}">
    <link rel="stylesheet" href="{% static 'css/image-picker.css' %}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.css" rel="stylesheet">


    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/font-awesome.css' %}">
    <link rel="stylesheet" href="{% static '/css/w3.css' %}">
    <link rel="stylesheet" href="{% static '/css/dataTable.css' %}">
    <link rel="stylesheet" href="{% static '/css/custom_style.css' %}">
    <link rel="stylesheet" href="{% static 'tags/css/bootstrap-tagsinput.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-datetimepicker.min.css' %}">
    <link rel="stylesheet" href="{% static '/css/KBmapmarkers.css' %}">
    <link rel="stylesheet" href="{% static '/css/dataTables.bootstrap.min.css' %}">

    <link href="{% static  'css/jquery-ui.css' %}" rel="stylesheet" type="text/css">
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>

    <link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">


    <script type="text/javascript" src="{% static 'js/underscore-min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lodash.min.js' %}"></script>

    <script src="{% static 'js/customJS.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>


    <script src="{% static 'datetime/js/moment.js' %}"></script>
    <script src="{% static 'datetime/js/moment-with-locales.js' %}"></script>
    <script src="{% static 'datetime/js/collapse.js'%}"></script>
    <script src="{% static 'datetime/js/transition.min.js' %}"></script>
    <script src="{% static 'js/printThis.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.9.4/cytoscape.min.js"></script>

    <script src="{% static 'datetime/js/bootstrap-datetimepicker.min.js' %}"></script>
    <!--<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>-->

    <!--Tags-->
    <link href="{% static 'css/select2.min.css' %}" rel="stylesheet"/>
    <script src="{% static 'js/select2.min.js' %}"></script>
    <!--Tags End-->

    <!-- BootStrap Notify Includes -->
    <script src="{% static 'js/toastr.min.js' %}"></script>

    <!-- Bootstrap Notify Includes end -->
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet"/>

    <link href="{% static 'css/pe-icon-7-stroke.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/ct-navbar.css' %}" rel="stylesheet"/>

    <!--    <link href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css" rel="stylesheet"/>-->

    <!--     Font Awesome     -->
    <link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet">
    <script src="{% static 'js/prettify.js' %}"></script>
    <link href="{% static 'css/prettify.css' %}" rel="stylesheet"/>
    <link href='https://fonts.googleapis.com/css?family=Grand+Hotel' rel='stylesheet' type='text/css'>
    <script src="{% static 'js/filepond.js' %}"></script>
    <!--     <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>-->
    <!--    <script src="https://code.jquery.com/jquery-3.0.0.slim.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.3.2/svg.min.js"></script>
    <script src="{% static 'js/workflowChart.js' %}"></script>
    <script src="{% static 'js/image-picker.js' %}"></script>
    <script src="{% static 'js/dropzone.js' %}"></script>


    <style>
        .container.tim-container{
            width:99%;
        }
        .navbar-transparent{
            background-color:#34ACDC;
            background-color:rgba(52, 172, 220, 0.98);
        }
         .modal{
            position: fixed !important;
         }

        .container.tim-container{
            width:100%;
        }

        .row-flex {
            display: flex;
            flex-wrap: wrap;
            padding-bottom:20px;
        }
        .content {
            height: 100%;
            padding: 20px 20px 10px;
            color: #fff;
        }
        img.image_picker_image{
            max-width:400px;
            max-height:400px;
            width:400px;
            height:200px;
        }
        .dropzone.dz-clickable {
            cursor: pointer;
            background-image: url(http://www.charlestonsteelandmetal.com/wp-content/uploads/2011/07/csm-BKG4.jpg);
        }
         .dropzone.dz-clickable .dz-message>span{
            color:white;
         }

        .img-wrap {
            position: relative;
            display: inline-block;
            border: 1px red solid;
            font-size: 0;
        }
        .img-wrap .close {
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 100;
            background-color: #FFF;
            padding: 5px 2px 2px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            opacity: .2;
            text-align: center;
            font-size: 22px;
            line-height: 10px;
            border-radius: 50%;
        }
        .img-wrap:hover .close {
            opacity: 1;
        }
        .img-responsive,
        .thumbnail > img,
        .thumbnail a > img,
        .carousel-inner > .item > img,
        .carousel-inner > .item > a > img {
            display: block;
            max-width: 100%;
            height: 618px;
        }

    </style>

    <script>
        $(document).ready(function() {
            // Animate loader off screen
            $(".se-pre-con").fadeOut("slow");
        });
    </script>
</head>

<body>
<div class="se-pre-con"></div>

<div id="navbar-full">
    <div id="navbar">
        <nav class="navbar navbar-ct-blue navbar-fixed-top navbar-transparent" role="navigation">
            <ul class="nav navbar-nav" style="float:none">
                <li class="news-update" style="width:100%">
                    <marquee style="margin-top: 0px;" id="news_bulletin" behavior="left" onmouseover="this.stop();"
                             onmouseout="this.start();">
                    </marquee>
                </li>
            </ul>
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse"
                            data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand navbar-brand-logo" href="/">
                        <div class="logo">
                            <img src="{% static '/image/csir_logo.svg' %}" width="60px">
                        </div>
                        <div class="brand" style="">Development of Digital Mine Using Internet of Things (IoT).</div>
                    </a>
                </div>
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="javascript:void(0);" data-toggle="search" class="hidden-xs">
                                <i class="pe-7s-search"></i>
                                <p>Search</p>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="pe-7s-mail">
                                    <span class="label">23</span>
                                </i>
                                <p>Messages</p>
                            </a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="pe-7s-user">
                                    <span class="label incomplete_profile_check hidden">Update Profile</span>
                                </i>
                                <p>Account <b class="caret"></b></p>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="divider"></li>
                                <li class="text-center"><img src="" width="100px" height="100px"
                                                             onerror="this.onerror=null;this.src='/media/employee_image/male_alt_photo.svg';"
                                                             class="avatar img-circle"></li>
                                <li class="divider"></li>
                                <li><a href="#"><span class="glyphicon glyphicon-dashboard"></span> Dashboard</a></li>
                                <li><a href="/accounts/profile/overview/"><span class="glyphicon glyphicon-off"></span>
                                    Profile</a></li>

                                <li class="divider"></li>
                                <li><a href="/accounts/logout"><span class="glyphicon glyphicon-off"></span> Sign
                                    Out</a></li>
                            </ul>
                        </li>
                    </ul>
                    <form class="navbar-form navbar-right navbar-search-form" role="search">
                        <div class="form-group">
                            <input type="text" value="" class="form-control" placeholder="Search...">
                        </div>
                    </form>

                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>
        <div class="blurred-container">
            <div id="myCarousel" class="carousel slide" data-ride="carousel">
                <!-- Indicators -->
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                    <li data-target="#myCarousel" data-slide-to="1"></li>
                    <li data-target="#myCarousel" data-slide-to="2"></li>
                </ol>

                <!-- Wrapper for slides -->
                <div class="carousel-inner">

                    <div class="item active">
                        <img src="/media/{{Carousal.0}}" onerror="this.onerror=null;this.src='{% static '/image/bg_img.jpg' %}';" alt="Chicago" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>Digital Mine</h3>
                            <p>LA is always so much fun!</p>
                        </div>
                    </div>

                    <div class="item">
                        <img src="/media/{{Carousal.1}}" onerror="this.onerror=null;this.src='{% static '/image/bg_img.jpg' %}';" alt="Chicago" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>Digital Mine</h3>
                            <p>Thank you, Chicago!</p>
                        </div>
                    </div>

                    <div class="item">
                        <img src="/media/{{Carousal.2}}"  onerror="this.onerror=null;this.src='{% static '/image/bg_img.jpg' %}';" alt="New York" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>Digital Mine</h3>
                            <p>We love the Big Apple!</p>
                        </div>
                    </div>

                </div>

                <!-- Left and right controls -->
                <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <!--            <div class="img-src" style="background-image: url('static/image/bg_img.jpg')"></div>-->
            <div class="row">
                <div class="col-md-12" style="margin-top:60px;">
                    <div class="col-md-1" style="margin-left:20px;width:5%;">
                        <div class="row">

                            <div class="row">

                            </div>
                        </div>
                        <div class="col-md-2 logo-text" style="margin-top:20px;">


                        </div>
                    </div>
                </div>
            </div>
        </div><!--  end navbar -->

    </div> <!-- end menu-dropdown -->

    <div class="main">

        <form action="{% url 'theme:upload_picture' %}" class="dropzone" drop-zone id="MyDropZone">
            {% csrf_token %}
            <div class="fallback">
                <h3>Your browser is not supported.</h3>
                <strong>
                    <a href="https://browser-update.org/update.html" target="_blank">Click here for instructions on how
                        to update it.</a>
                </strong>
                <p>You can still try to upload your pictures through this form: </p>
                <p>
                    <input name="file" type="file" multiple/>
                    <input type="submit" value="Upload"/>
                </p>
            </div>
        </form>
        <div class="text-center" style="padding-bottom:20px;padding-top:20px;">
            <button type="button" class="btn btn-success text-center" id="update_carousal">Update Carousal</button>
        </div>
        <select multiple="multiple" class="image-picker show-html">
        </select>

    </div>
    <br>

    <p class="text-center">Powered By <a href="http://www.cimfr.nic.in/" target="_blank">CSIR-CIMFR</a> | Copyright
        &copy;
        Protected | All Rights Reserved.</p>

</div>
<div class="modal fade" style="position:absolute" id="update_info" role="dialog">
    <div class="modal-dialog modal-confirm ">
        <div class="modal-content">
            <div class="modal-header">
                <div class="icon-box">
                    <i class="material-icons">&#xE5CD;</i>
                </div>
                <h4 class="modal-title">Are you sure?</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
                <p>Do you really want to delete these records? This process cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <a id="sureDelete">
                    <button type="button" class="btn btn-danger" id="delete">Yes</button>
                </a>
                <button type="button" class="btn btn-default" data-dismiss="modal">No</button>

            </div>
        </div>
    </div>
</div>

</body>
<script src="{% static 'js/ct-navbar.js' %}"></script>
<script>
var X;

$(document).ready(function(){
    toastr.options = {
                    "closeButton": false,
                    "debug": false,
                    "newestOnTop": true,
                    "progressBar": false,
                    "positionClass": "toast-bottom-full-width",
                    "preventDuplicates": true,
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "100",
                    "timeOut": "3000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut",
                    }

    function get_all_carousal_images(){
            $.ajax({
           url: "{% url 'theme:get_all_carousal_images_ajax' %}",
           success:function(data){

                 if(data.hasOwnProperty('result') ){
                    data=JSON.parse(data.result);

                    active=[];
                    for(d in data){
                        file=data[d].fields.file;
                        console.log(file);
                        id=data[d].pk;
                        if(data[d].fields.active=='1'){
                            active.push(id);
                        }

                    $('select.image-picker.show-html').append('<option data-img-src="/media/'+file+'" value="'+id+'">Cute Kitten 1</option>')
                   }
                }
                 $("select").imagepicker({limit:3,limit_reached: function(){toastr.info('Only 3 Images can be saved!')}});
                 $(".image-picker").val(active);
                 $(".image-picker").data('picker').sync_picker_with_select();

           },
           error:function(){
                console.log('Something Went Wrong!');

           }

        });
    }
    get_all_carousal_images();


    $('button#update_carousal').click(function(){
        X=$("select").data('picker');
        selected_images=X.selected_values();

        $.ajax({
            url: "{% url 'theme:activate_carousal' %}",

            data:{
                'selected_images[]':selected_images,
            },
            success:function(data){
                     if(data.hasOwnProperty('success') ){
                        toastr.info('Successfully Updated!');
                        setTimeout(function() {
                            location.reload();
                        }, 3000);
                        return data
                     }
                     toasr.warning('Something Went Wrong!');
                     return false;

            },
           error:function(){
                toastr.warning('Something Went Wrong!');

                console.log('Something Went Wrong!');
           }
    });

    });

    $(document).on("click",".img-wrap .close",function() {
        var id = $(this).closest('.img-wrap').find('img').data('id');
        $('#update_info').modal('show');
        $('#update_info').on('click', '#delete', function(e) {
        $('#update_info').unbind('click');
        $('#update_info').modal('hide');
        $.ajax({
            type:"post",
            url: "{% url 'theme:delete_carousal' %}",
            data:{
                csrfmiddlewaretoken: "{{ csrf_token }}",
                'id':id,
            },
            success:function(json){
                if(json.hasOwnProperty("success")){
                toastr.success(json.success);
                   location.reload(true);
                }
                else{toastr.error(json.error);}
            },
            error: function(){
                    console.log("something is not right.please contact admin - 1");
            }});
        });

    });

});

</script>
</html>

{% endblock %}
